<!DOCTYPE html>
<html lang="en">
<head>
  <meta content="HTML Tidy for HTML5 for Mac OS X version 5.2.0" name="generator">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="A small software development company based in London, UK." name="description">
  <meta content="GNqgxou6cYLkYq9l47mZM00R93JN49KqRhJebklH7uo" name="google-site-verification">
  <meta content="width=device-width" name="viewport">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <link href="/assets/application-e4364b3782cc7477f226bc8504403fa41bfb8d1f7a4ed67eb3fe80f20bd5b014.css" media="all" rel="stylesheet">
  <link href="http://feeds.gofreerange.com/GoFreeRangeBlog" rel='alternate' title='Go Free Range Blog' type='application/atom+xml'>
  <script src='http://use.typekit.com/rny4upv.js' type='text/javascript'>
  </script>
  <script>
  try{Typekit.load();}catch(e){}
  </script>
  <title>Week 347 — Go Free Range.</title>
</head>
<body class="blog">
  <div id="page">
    <div class="group" id="header">
      <ul class='nav group' id='blog_nav'>
        <li id='link_home'>
          <p>Visit our <a href='/'>company website</a></p>
        </li>
        <li id='link_rss'>
          <p>Grab the <a href='http://feeds.gofreerange.com/GoFreeRangeBlog' title='RSS Feed from Feedburner'>RSS</a> feed</p>
        </li>
      </ul>
      <h1 id="logo"><a href="/blog" title="Go to blog index">Blog index</a></h1>
    </div>
    <div class="group" id="content">
      <div class="blog_entry group">
        <p class="article_date">Friday 11th September, 2015</p>
        <div class="author">
          <img alt="James Mead" src="images/people/james-mead.jpg"> <span>by James Mead</span>
        </div>
        <div class="content">
          <h1 id="week-347">Week 347</h1>
          <p>We did the usual 4:1 split of days between Smart Answers and GFR, spending Tuesday and Thursday at Aviation House and Monday, Wednesday & Friday at GFRHQ. <a href="http://codeme.lt/">Tadas</a> came to GFRHQ to work with us on Wednesday.</p>
          <h2 id="smart-answers">Smart Answers</h2>
          <h3 id="tax-credits-award-finalisation">Tax Credits Award Finalisation</h3>
          <p>This week <a href="/chris-roos">Chris</a> has been focussing on the <a href="https://github.com/alphagov/smart-answers/pull/1942">Part-year profit for Tax Credits smart answer</a>, but as part of that he also took some time to <a href="https://github.com/alphagov/smart-answers/pull/1935">simplify <code>Question::Date</code></a>. On Monday I paired with Chris on this smart answer which he’d kindly taken over for me while I’d been on holiday.</p>
          <p>As we’ve mentioned before getting the logic right for this smart answer has been a real challenge and has sucked up a lot of our time. However, it’s been a really useful glimpse into the process for developing new smart answers.</p>
          <h3 id="general-improvements">General Improvements</h3>
          <p>Early in the week I used <a href="https://github.com/bbatsov/rubocop/wiki/Automatic-Corrections">Rubocop’s auto-correct</a> functionality to <a href="https://github.com/alphagov/smart-answers/commit/4cb96a4d66521af1ec0ff130e30c1b08476634db">convert all of our Hash syntax to Ruby 1.9-style</a> thereby <a href="https://github.com/alphagov/smart-answers/pull/1867#issuecomment-138568472">closing an outstanding pull request</a> from <a href="http://cogentia.io/">Andrew Scott</a>.</p>
          <p>I then got Tadas’ pull request for <a href="https://github.com/alphagov/smart-answers/pull/1908">enabling regression tests for landing pages</a> merged and then spent most of the week <a href="https://github.com/alphagov/smart-answers/pull/1941">converting landing pages in Smart Answer flows to use ERB templates</a>.</p>
          <p>Apart from fighting his way valiantly through the usual monthly changes for FCO-related smart answers, Tadas has also found time to work on a number of useful improvements:</p>
          <ul>
            <li>
              <a href="https://github.com/alphagov/smart-answers/pull/1932">Make outcome pages available in Govspeak format in the preview environment</a>. The idea is that content editors will be able to copy existing Govspeak text, modify it, and supply the modified version to developers; previously they could only easily obtain the rendered HTML, which made <code>diff</code>-ing difficult.
            </li>
            <li>
              <a href="https://github.com/alphagov/smart-answers/pull/1936">Normalise blank lines between paragraphs in Govspeak</a>. Having more than one consecutive blank line in Markdown/Govspeak generates the same HTML as having a single blank line. This change normalises the Govspeak to always use a single blank line. The main benefit will be to reduce noise in the Govspeak text stored in the regression test artefacts i.e. it should be a lot easier to review the changes.
            </li>
            <li>
              <a href="https://github.com/alphagov/smart-answers/pull/1939">Halve the time it takes to run regression tests</a>. Previously we were shelling out to <code>git diff</code> to make an assertion about each outcome page. However, if we don’t need to fail fast, we can just rely on the final assertion which uses <code>git status --short</code> against each flow’s directory which runs after all outcomes have been exercised.
            </li>
          </ul>
          <h3 id="handover--refactoring">Handover & Refactoring</h3>
          <p>On Tuesday afternoon, Chris paired with <a href="https://twitter.com/jenny_duckett">Jenny Duckett</a> and <a href="http://dsingleton.co.uk/">David Singleton</a> on refactoring the <a href="https://www.gov.uk/calculate-agricultural-holiday-entitlement">calculate-agricultural-holiday-entitlement</a> smart answer. Chris had chosen this flow, because, although it may not be the most important, it demonstrates a number of the problems we’re interested in fixing and it’s small enough to be tractable.</p>
          <p>The main thing we’re aiming to achieve when doing these refactorings is to better separate the concerns:</p>
          <ul>
            <li>Move policy logic from flow classes & ERB templates into <a href="http://blog.jayfields.com/2007/10/ruby-poro.html">PORO</a> policy model classes
            </li>
            <li>Move presentational logic from policy model & flow classes into ERB templates & helper methods</li>
            <li>Move validation logic into policy model classes</li>
          </ul>
          <p>A while ago Chris spent some time <a href="https://github.com/alphagov/smart-answers/pull/1856">doing this kind of refactoring</a> for the two Minimum Wage related flows (i.e. <a href="https://www.gov.uk/minimum-wage-calculator-employers">minimum-wage-calculator-employers</a> & <a href="https://www.gov.uk/am-i-getting-minimum-wage">am-i-getting-minimum-wage</a>). And we’ve been taking a similar approach with the new Tax Credit related flow. We’re confident that these changes make the code easier to follow and easier to unit test.</p>
          <p>Jenny’s <em>Custom Formats</em> team is taking on responsibility for Smart Answers and we’re keen to transfer as much knowledge as possible in person rather than just via documentation, so it was great that Jenny & David could spare the time to do this. We hope it was useful and that we can do some more in the near future.</p>
          <h3 id="fco-smart-answers">FCO Smart Answers</h3>
          <p>On Wednesday while Tadas was at our office we took the opportunity to have a bit of a discussion about how we might improve things for FCO smart answers (e.g. <a href="https://www.gov.uk/marriage-abroad">marriage-abroad</a> & <a href="https://www.gov.uk/overseas-passports">overseas-passports</a>), especially given that Tadas is going to move onto another project soon. These smart answers are some of the most complicated ones and more importantly are the most frequently updated ones. We came up with a few ideas to improve matters - we hope there’s enough time to put at least some of the ideas into action.</p>
          <h3 id="lunch-in-the-park">Lunch in the Park</h3>
          <p>On Thursday we took advantage of the sunny weather to have lunch on the grass in <a href="https://en.wikipedia.org/wiki/Lincoln%27s_Inn_Fields">Lincoln’s Inn Fields</a> with Tadas and <a href="https://twitter.com/mo_baig">Mo Baig</a>. That afternoon Chris chatted to Liz about the Part-year profit for Tax Credits smart answer in preparation for publishing a new version for Gill at HMRC.</p>
          <h3 id="multiple-questions-per-page">Multiple Questions per Page</h3>
          <p>And at the end of the day we had a chat with <a href="http://anti-mega.com/">Chris Heathcote</a> about <a href="https://www.gov.uk/pay-leave-for-parents">pay-leave-for-parents</a> (aka Shared Parental Leave). This is the last remaining <a href="https://github.com/alphagov/smartdown">Smartdown</a> Smart Answer and we’re keen to convert it to be a Ruby smart answer. However, it contains a couple of places where there are multiple questions <em>per page</em>. This is not currently supported in Ruby smart answers and so we need to work out whether the functionality is important enough to reimplement in Ruby smart answers or whether (for now at least) we can get away with splitting those pages so there is only ever one question per page.</p>
          <p>Chris H said that as far as he could remember the questions were grouped on one page, because there were a <em>lot</em> of questions for the user to answer and there were a couple of groups of questions that were very closely related. He said that he couldn’t see a problem with splitting them up onto separate pages in the short term as long as we checked that this didn’t make the user experience significantly worse e.g. by using the <a href="https://gds.blog.gov.uk/2014/12/03/our-gds-user-research-lab-is-6-months-old/">GDS User Research Lab</a> and/or by analysing data from analytics.</p>
          <h2 id="gfr">GFR</h2>
          <p>On Tuesday I went to the <a href="http://london.computation.club/">London Computation Club</a> meeting where brainstormed ideas for books & papers to work on next.</p>
          <p>On Wednesday Chris & I held our <a href="/show-and-tell-16">16th Show & Tell event</a>.</p>
          <p>Friday was the usual GFR admin-fest. Chris wrote-up the <a href="/week-346">notes for week 346</a> and I wrote up notes on the Show & Tell. Chris renewed the SSL certificate for <a href="https://video.gofreerange.com">video.gofreerange.com</a> and I started writing up these notes. Fun, fun, fun!</p>
          <p>Until next time.</p>
          <p>– James</p>
        </div>
        <div class="comments" id="comments">
          Disqus commenting is only enabled in production.
        </div>
      </div>
      <div id="article_links">
        <h3>Recent</h3>
        <div id="recent_articles">
          <ol class="blog_list" reversed="">
            <li value="6">
              <a href="/week-446-links">Week 446 - Interesting links</a>
            </li>
            <li value="5">
              <a href="/week-444">Week 444</a>
            </li>
            <li value="4">
              <a href="/week-444-links">Week 444 - Interesting links</a>
            </li>
            <li value="3">
              <a href="/week-443">Week 443</a>
            </li>
            <li value="2">
              <a href="/week-441">Week 441</a>
            </li>
            <li value="1">
              <a href="/week-442">Week 442</a>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <script src="/assets/application-a06a15e76d88968aa98de5792d639d527018444227ecda8004f3fb4a3e0d1d6f.js">
  </script> 
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45002715-1', 'gofreerange.com');
  ga('send', 'pageview');

  </script>
</body>
</html>
