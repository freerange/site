<!DOCTYPE html>
<html lang="en">
<head>
  <meta content="HTML Tidy for HTML5 for Mac OS X version 5.2.0" name="generator">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="A small software development company based in London, UK." name="description">
  <meta content="GNqgxou6cYLkYq9l47mZM00R93JN49KqRhJebklH7uo" name="google-site-verification">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="ruby rails software development london" name="keywords">
  <meta content="telephone=no" name="format-detection">
  <link href="/assets/application-1507e54ca8e8109b8f18bb949aa6426ff1f387a59a864a86de4dbd371b20b242.css" media="all" rel="stylesheet">
  <link href="/favicon.ico" rel="shortcut icon">
  <link href="http://feeds.gofreerange.com/GoFreeRangeBlog" rel="alternate" title="Go Free Range Blog" type="application/atom+xml">
  <script src="http://use.typekit.com/rny4upv.js" type="text/javascript">
  </script>
  <script>
  try{Typekit.load();}catch(e){}
  </script>
  <title>Week 468 — Go Free Range.</title>
</head>
<body class="blog">
  <div id="page">
    <div class="group" id="header">
      <ul class="nav group" id="blog_nav">
        <li id="link_home">
          <p>Visit our <a href="/">company website</a></p>
        </li>
        <li id="link_rss">
          <p>Grab the <a href="http://feeds.gofreerange.com/GoFreeRangeBlog" title="RSS Feed from Feedburner">RSS</a> feed</p>
        </li>
      </ul>
      <h1 id="logo"><a href="/blog" title="Go to blog index">Blog index</a></h1>
    </div>
    <div class="group" id="content">
      <div class="blog_entry group">
        <p class="article_date">Friday 5th January, 2018</p>
        <div class="author">
          <img alt="James Mead" src="images/people/james-mead.jpg"> <span>by James Mead</span>
        </div>
        <div class="content">
          <h1 id="week-468">Week 468</h1>
          <p>Happy New Year, everyone!</p>
          <p>With New Year’s Day on Monday, this was a short week. I was back at work on Tuesday, Chris L on Wednesday, and Chris R on Friday. Chris L & I worked from home and then Chris R & I worked at TOG Bloomsbury on Friday.</p>
          <p>We hired the delightfully triangular meeting room again to have our weekly company meeting - this meant Chris L could participate remotely via <a href="https://appear.in">appear.in</a> on a giant TV screen. We’ve done this a couple of times now and I feel as if the meetings have been very useful and productive.</p>
          <h2 id="gds---asset-management">GDS - Asset Management</h2>
          <p>We continued to make steady progress on the project:</p>
          <h3 id="asset-manager">Asset Manager</h3>
          <p>The main change was to have the app <a href="https://github.com/alphagov/asset-manager/pull/373">delete the asset file from NFS when the upload to S3 succeeds</a>. This reflects the fact that Asset Manager has for some time been serving assets by proxying requests to S3 rather than serving them directly from disk. This means that the disk usage on the Asset Manager part of the NFS mount should no longer grow when we add new assets which will make it easier to migrate exiting Whitehall assets to Asset Manager.</p>
          <p>This pull request also adds a Rake task which will allow us to delete the files for all existing assets whose files have been uploaded to S3. However, we need to make some other changes to backup/sync-ing tasks before we can do this. To this end we’ve hatched <a href="https://github.com/alphagov/asset-manager/issues/296#issuecomment-355349244">a plan</a> and prepared a number of pull requests to prepare the ground for implementing it:</p>
          <ul>
            <li>
              <a href="https://github.com/alphagov/govuk-puppet/pull/6768">Remove nightly off-site backup of Asset Manager assets from production NFS to S3</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/govuk-puppet/pull/7016">Remove sync-asset-manager-from-master cron job from asset slaves</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/govuk-puppet/pull/7019">Disable nightly sync of Asset Manager assets from asset-slave-2 to S3</a>
            </li>
          </ul>
          <p>Along the way we <a href="https://github.com/alphagov/asset-manager/pull/369">fixed a minor bug</a> where (in between an asset being virus scanned and being uploaded to S3), it was possible for Whitehall asset requests to result in a 404 Not Found rather than a redirect to a placeholder which is what happens when the asset is being virus scanned.</p>
          <p>We also did a bunch of refactoring, tidying up, upgrading gems, and improving documentation & graphing:</p>
          <ul>
            <li>
              <a href="https://github.com/alphagov/asset-manager/pull/365">Upgrade govuk_sidekiq to v3</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/asset-manager/pull/367">Revert addition of Rake task to update state of assets to uploaded</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/asset-manager/pull/372">Convert VirusScanner class into stateless service</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/asset-manager/pull/374">Improve documentation for manual testing in integration</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/asset-manager/pull/375">Add test coverage for scripts</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/govuk-developer-docs/pull/641">Update assets documentation</a>
            </li>
            <li>
              <a href="https://github.com/alphagov/govuk-puppet/pull/7012">Display Sidekiq graphs & stats on Asset Manager deployment dashboard</a>
            </li>
          </ul>
          <h3 id="whitehall">Whitehall</h3>
          <p>Before Christmas we noticed that some hidden files on the Whitehall part of the NFS mount weren’t being migrated to Asset Manager. Since <em>all</em> files on this part of the NFS mount are publicly accessible, we decided to preserve the behaviour and <a href="https://github.com/alphagov/whitehall/pull/3658">ensure hidden files are migrated to Asset Manager</a> in all future migrations. We also identified a couple of these files which we’d missed in a previous migration and migrated them manually.</p>
          <h3 id="miscellaneous">Miscellaneous</h3>
          <p>We also <a href="https://github.com/alphagov/govuk-puppet/pull/7021">removed some cron job definitions from the Puppet recipes</a> which someone had marked as absent some time ago, but forgotten to remove.</p>
          <h2 id="gfr">GFR</h2>
          <p>Given the short week and the focus on the GDS project, we didn’t do anything more than the usual company admin. However, we did make our monthly donation to charity - this month I chose <a href="https://www.crisis.org.uk/">Crisis</a>.</p>
          <p>I should also mention that I managed to do a bit of work on a couple of side projects over the Christmas break, i.e. <a href="https://github.com/freerange/ais-on-sdr">AIS on SDR</a> and building Linux containers from scratch. However, I’ll save further explanation for <a href="https://attending.io/events/gfr-show-and-tell-40">Show & Tell 40</a> (yes, the big four-oh!) which we’re holding next Wed, 10 Jan. Do please come along if you can - we’d love to see you!</p>
          <p>Wishing you good health, happiness and prosperity for 2018!</p>
          <p>– James</p>
        </div>
        <div class="comments" id="comments">
          Disqus commenting is only enabled in production.
        </div>
      </div>
      <div id="article_links">
        <h3>Recent</h3>
        <div id="recent_articles">
          <ol class="blog_list" reversed="">
            <li value="6">
              <a href="/week-481">Week 481</a>
            </li>
            <li value="5">
              <a href="/week-480">Week 480</a>
            </li>
            <li value="4">
              <a href="/week-477">Week 477</a>
            </li>
            <li value="3">
              <a href="/week-479">Week 479</a>
            </li>
            <li value="2">
              <a href="/week-478">Week 478</a>
            </li>
            <li value="1">
              <a href="/week-478-links">Week 478 - Interesting links</a>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <script src="/assets/application-a06a15e76d88968aa98de5792d639d527018444227ecda8004f3fb4a3e0d1d6f.js">
  </script> 
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45002715-1', 'gofreerange.com');
  ga('send', 'pageview');

  </script>
</body>
</html>
